<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#B2E5D4">
<title>Моя Копилка</title>

<!-- Иконка PWA -->
<link rel="icon" href="icon.svg" type="image/svg+xml">
<link rel="manifest" href="manifest.json">

<style>
body {
  margin: 0;
  font-family: 'Arial', sans-serif;
  background-color: var(--bg, #fff);
  color: var(--text, #333);
}
header {
  padding: 10px;
  text-align: center;
  font-size: 1.4em;
}
.goal-container {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
}
.goal {
  min-width: 90%;
  margin: 10px;
  background: var(--card, #f9f9f9);
  border-radius: 12px;
  padding: 20px;
  scroll-snap-align: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.goal img {
  width: 100%;
  border-radius: 8px;
}
button {
  background: var(--accent, #B2E5D4);
  border: none;
  padding: 10px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 1em;
}
.settings {
  position: fixed;
  bottom: 10px;
  right: 10px;
}
</style>
</head>
<body>

<header id="app-title">Моя Копилка</header>

<div class="goal-container" id="goalList"></div>

<div style="text-align:center;margin:20px;">
  <button onclick="addGoal()">+ Добавить цель</button>
</div>

<button class="settings" onclick="openSettings()">⚙️</button>

<script>
let goals = JSON.parse(localStorage.getItem('goals')||'[]');
let lang = localStorage.getItem('lang') || 'ru';
let theme = localStorage.getItem('theme') || 'mint';

const langs = {
  ru: { title: "Моя Копилка", add: "+ Добавить цель" },
  en: { title: "My Piggy Bank", add: "+ Add goal" }
};

const themes = {
  mint: { '--bg': '#ffffff', '--card': '#f4fffc', '--accent': '#B2E5D4', '--text': '#333' },
  beige: { '--bg': '#ffffff', '--card': '#fffaf4', '--accent': '#F5E6CC', '--text': '#333' },
  lavender: { '--bg': '#ffffff', '--card': '#f9f4ff', '--accent': '#D8B4E2', '--text': '#333' },
  blue: { '--bg': '#ffffff', '--card': '#f4f9ff', '--accent': '#A8D0E6', '--text': '#333' }
};

function applyTheme() {
  let t = themes[theme];
  for (let key in t) document.documentElement.style.setProperty(key, t[key]);
}

function renderGoals() {
  document.getElementById('app-title').textContent = langs[lang].title;
  let html = '';
  goals.forEach((g,i)=>{
    html += `<div class="goal">
      <img src="${g.img}" alt="">
      <h3>${g.name}</h3>
      <p>Баланс: ${g.balance}</p>
      <button onclick="addMoney(${i}, 100)">+100</button>
      <button onclick="spendMoney(${i}, 100)">-100</button>
    </div>`;
  });
  document.getElementById('goalList').innerHTML = html;
}

function addGoal() {
  let name = prompt(lang==='ru' ? 'Название цели:' : 'Goal name:');
  let img = prompt(lang==='ru' ? 'Ссылка на картинку:' : 'Image URL:') || 'icon.svg';
  goals.push({ name, img, balance: 0 });
  saveGoals();
}

function addMoney(i, amount) {
  goals[i].balance += amount;
  saveGoals();
}

function spendMoney(i, amount) {
  goals[i].balance -= amount;
  saveGoals();
}

function saveGoals() {
  localStorage.setItem('goals', JSON.stringify(goals));
  renderGoals();
}

function openSettings() {
  let newLang = prompt('Language? (ru/en)', lang);
  if (newLang) { lang = newLang; localStorage.setItem('lang', lang); }
  let newTheme = prompt('Theme? (mint/beige/lavender/blue)', theme);
  if (newTheme) { theme = newTheme; localStorage.setItem('theme', theme); }
  applyTheme();
  renderGoals();
}

// PWA
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}

applyTheme();
renderGoals();
</script>
</body>
</html>
